# TURN Server Configuration for Battleship WebRTC
# Optimized for mobile P2P connections and NAT traversal

# Network Interface and Listening Ports
listening-port=3478
listening-ip=0.0.0.0
tls-listening-port=5349
alt-listening-port=3479
alt-tls-listening-port=5350

# Relay IP Configuration
# External IP will be auto-detected. For explicit setting:
external-ip=${EXTERNAL_IP}

# Realm - used for TURN protocol authentication
realm=battleship-webrtc.local

# Credentials - simple authentication
# For production, use more secure authentication methods
user=webrtc:webrtcPassword123

# Verbose logging for debugging
verbose

# Log file location
log-file=/var/log/coturn/coturn.log

# Performance tuning
max-bps=0
bps-capacity=0
total-quota=100
user-quota=100

# Turn server specific options
# Allow all relay protocols
#allow-loopback-peers

# Set cli-username for admin access (allow-loopback-peers urges for setting an admin access)
#cli-user=admin
#cli-password={adminPasswordCL1}

# Enable fingerprinting for enhanced security
fingerprint

# Enable XOR-encoded addresses (required for many clients)
#no-stun

# Performance options for high-traffic scenarios
no-multicast-peers
#allow-unknown-peers
#mobility

# Session timeout
max-allocate-lifetime=3600

# Bandwidth limit per connection (in bytes/sec, 0 = unlimited)
# Set to 0 for testing, adjust for production
bps-capacity-quantum=2000

# TLS Options (for secure TURN over TLS/DTLS)
# If using TLS, certificates should be in /etc/coturn/certs/
cert=/etc/coturn/certs/cert.pem
pkey=/etc/coturn/certs/key.pem
# cipher-list="DEFAULT"

# Enable CORS-like headers for web clients
web-admin-listen-port=5050

# Mobile-optimized settings
# Reduce keep-alive interval for better mobile connectivity
keepalive-timeout=300

# Limit number of open ports
# max-bps is unlimited (0)
# User bandwidth quota
user-quota=100000
total-quota=10000000

# Recommended settings for mobile networks
# Handle connection drops gracefully
drop-packets-period=20000

# Nat behavior mapping (helps with NAT traversal)
# Leave empty to auto-detect

# Security: restrict to valid realms
check-origin-consistency

# DTLS/TLS timeout
dtls-timeout=15000

# Session options
min-allocate-lifetime=300
default-allocate-lifetime=600
max-allocate-lifetime=3600
